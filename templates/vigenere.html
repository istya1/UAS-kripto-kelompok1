<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <title>Vigenere Cipher</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    function copyText() {
      const text = document.getElementById("cipherResult").innerText;
      navigator.clipboard.writeText(text);
    }
  </script>
</head>

<body class="bg-white text-white">

  <!-- Navbar include -->
  {% include 'component/navbar.html' %}

  <!-- Konten utama dengan background -->
  <section
    class="flex flex-col justify-start items-center text-center px-6 bg-cover bg-center relative min-h-screen pt-24"
    style="background-image: url('{{ url_for('static', filename='back.jpg') }}');">

    <!-- Overlay -->
    <div class="absolute inset-0 bg-black bg-opacity-80"></div>

    <!-- Konten form Vigenere -->
    <div class="relative z-10 bg-gray-900/90 p-8 rounded-xl shadow-lg w-full max-w-3xl">
      <h1 class="text-3xl text-center font-bold text-blue-600 mb-6">Vigenere Cipher</h1>

      <!-- Form Input -->
      <form method="POST" class="space-y-4">
        <textarea name="text" placeholder="Masukkan teks (plaintext/ciphertext)"
          class="w-full p-3 rounded bg-gray-800 text-white resize-none focus:outline-none focus:ring-2 focus:ring-blue-600"
          rows="4">{{ request.form.get('text', '') }}</textarea>

        <input type="text" name="key" placeholder="Masukkan key (teks)" value="{{ request.form.get('key', '') }}"
          class="w-full p-3 rounded bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-600" />

        <select name="mode"
          class="w-full p-3 rounded bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-600">
          <option value="encrypt" {% if request.form.get('mode')=='encrypt' %}selected{% endif %}>Enkripsi</option>
          <option value="decrypt" {% if request.form.get('mode')=='decrypt' %}selected{% endif %}>Dekripsi</option>
        </select>

        <button type="submit" class="w-full bg-blue-600 py-2 rounded-lg hover:bg-blue-700 transition">
          Proses
        </button>
      </form>

      <!-- Hasil -->
      {% if result %}
      <div class="mt-6 bg-gray-800 p-4 rounded-lg shadow-lg">
        <p class="font-semibold text-lg mb-2 text-blue-400">Hasil:</p>
        <p id="cipherResult" class="text-lg tracking-wider text-gray-100 break-words">{{ result }}</p>
        <button onclick="copyText()" 
                class="bg-gray-600 hover:bg-gray-500 px-3 py-1 rounded mt-3 transition duration-200">
          Copy
        </button>
      </div>

      <!-- Tabel Perhitungan -->
      <div class="mt-6 bg-gray-800 p-4 rounded-lg shadow-lg">
        <p class="font-semibold text-lg mb-3 text-blue-400">Proses Perhitungan:</p>
        <div class="overflow-x-auto">
          <table class="w-full text-sm text-left text-gray-300 border border-gray-700 rounded-lg">
            <thead class="bg-gray-700 text-gray-100">
              <tr>
                <th class="px-3 py-2 border border-gray-600">No</th>
                <th class="px-3 py-2 border border-gray-600">P (Plaintext)</th>
                <th class="px-3 py-2 border border-gray-600">K (Key)</th>
                <th class="px-3 py-2 border border-gray-600">(P + K) mod 36</th>
                <th class="px-3 py-2 border border-gray-600">Hasil (angka)</th>
                <th class="px-3 py-2 border border-gray-600">Hasil (huruf/angka)</th>
              </tr>
            </thead>
            <tbody>
              {% for step in process %}
              <tr class="hover:bg-gray-700 transition">
                <td class="px-3 py-2 border border-gray-700 text-center">{{ loop.index }}</td>
                <td class="px-3 py-2 border border-gray-700">{{ step.P }}</td>
                <td class="px-3 py-2 border border-gray-700">{{ step.K }}</td>
                <td class="px-3 py-2 border border-gray-700 text-center">
                  {% if step.hasil != "-" %}
                    ({{ step.P.split('->')[-1] }} + {{ step.K.split('->')[-1] }}) mod 36 = {{ step.hasil }}
                  {% else %}
                    -
                  {% endif %}
                </td>
                <td class="px-3 py-2 border border-gray-700 text-center">{{ step.hasil }}</td>
                <td class="px-3 py-2 border border-gray-700 font-semibold text-blue-400 text-center">
                  {{ step.char }}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

      <!-- Ringkasan -->
      <div class="mt-6 bg-gray-800 text-left p-4 rounded">
        <p class="font-semibold text-lg mb-3 text-blue-400">Ringkasan</p>
        <p><span class="font-semibold text-gray-300">Plaintext:</span>
          <span class="text-white">{{ request.form.get('text', '') }}</span></p>

        <p><span class="font-semibold text-gray-300">Key:</span>
          <span class="text-white">{{ request.form.get('key', '') }}</span></p>

        <p><span class="font-semibold text-gray-300">Ciphertext:</span>
          <span class="text-blue-400 font-bold text-lg">{{ result }}</span></p>
      </div>

      {% endif %}
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-black text-gray-500 text-center py-6 border-t border-gray-800">
    Â© 2025 Endes Kriptografi | Dibuat oleh Kelompok 1 Kriptografi
  </footer>

</body>
</html>
